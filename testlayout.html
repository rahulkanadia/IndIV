<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IndIV Monitor V2</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        /* --- THEME & FONTS --- */
        :root { 
            --bg: #0b0b0b; --card: #141414; --text: #e0e0e0; --border: #2a2a2a; 
            --green: #00E676; --red: #FF5252; 
            /* NEW THEME COLORS */
            --weekly: #FF9800; /* Orange */
            --monthly: #2196F3; /* Blue */
        }
        
        * { box-sizing: border-box; }
        body { 
            background: var(--bg); color: var(--text); 
            font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif; /* Unified Font */
            margin: 0; padding: 15px; height: 100vh; display: flex; flex-direction: column;
        }

        /* --- HEADER --- */
        .header-row { display: flex; align-items: center; gap: 20px; margin-bottom: 20px; border-bottom: 1px solid var(--border); padding-bottom: 10px; height: 50px; }
        h1 { margin: 0; font-size: 1.2rem; font-weight: 600; letter-spacing: 0.5px; color: #fff; }
        
        /* Asset Dropdown (Moved to Title Area) */
        .asset-select { 
            background: #222; color: #fff; border: 1px solid #444; 
            padding: 6px 12px; border-radius: 4px; font-size: 14px; 
            font-weight: bold; cursor: pointer; font-family: inherit;
        }

        /* Right Header Controls */
        .controls-right { margin-left: auto; display: flex; align-items: center; gap: 20px; font-size: 13px; }
        .status-box { text-align: right; line-height: 1.2; }
        .status-ok { color: var(--green); font-weight: bold; }
        .readme-link { color: #888; text-decoration: none; border: 1px solid #444; padding: 4px 10px; border-radius: 4px; font-size: 12px; }

        /* --- MAIN LAYOUT --- */
        .container { 
            display: flex; gap: 20px; flex: 1; overflow: hidden; /* Prevent body scroll */
        }

        /* --- LEFT PANEL (55% Width) --- */
        .left-panel { flex: 1; display: flex; flex-direction: column; gap: 15px; overflow-y: auto; padding-right: 5px; }

        /* Spot/Futures Box */
        .price-header-box { 
            display: flex; justify-content: space-around; align-items: center;
            background: var(--card); border: 1px solid var(--border); 
            padding: 12px; border-radius: 6px; 
        }
        .price-item { text-align: center; }
        .price-label { font-size: 11px; color: #666; display: block; margin-bottom: 2px; text-transform: uppercase; letter-spacing: 1px; }
        .price-val { font-size: 1.4rem; font-weight: 700; color: #fff; }
        .price-diff { font-size: 0.9rem; color: var(--green); margin-left: 8px; }

        /* SECTION TITLES */
        .section-title { 
            font-size: 14px; font-weight: 700; color: #fff; 
            margin: 10px 0 5px 0; display: flex; justify-content: space-between; align-items: center;
            border-bottom: 2px solid #222; padding-bottom: 5px;
        }
        .section-date { color: #888; font-weight: 400; font-size: 12px; }

        /* 3x2 DATA GRID */
        .data-grid-3x2 { 
            display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 8px; 
        }
        .data-box { 
            background: var(--card); border: 1px solid var(--border); 
            padding: 10px; text-align: center; border-radius: 4px; 
            display: flex; flex-direction: column; justify-content: center;
        }
        .lbl { font-size: 10px; color: #666; margin-bottom: 4px; text-transform: uppercase; letter-spacing: 0.5px; }
        .val-lg { font-size: 1.2rem; font-weight: 600; } /* Price */
        .val-xl { font-size: 1.4rem; font-weight: 700; font-family: 'Courier New', monospace; } /* IV */

        /* Colors */
        .c-weekly { color: var(--weekly); }
        .c-monthly { color: var(--monthly); }
        .c-green { color: var(--green); }
        .c-red { color: var(--red); }

        /* Chart Wrapper */
        .chart-box { height: 180px; background: var(--card); border: 1px solid var(--border); border-radius: 4px; padding: 10px; position: relative; }

        /* --- RIGHT PANEL (45% Width) --- */
        .right-panel { 
            width: 45%; min-width: 500px; 
            display: flex; flex-direction: column; 
            background: var(--card); border: 1px solid var(--border); border-radius: 6px;
        }

        /* Table Controls */
        .table-controls { 
            padding: 10px; border-bottom: 1px solid var(--border); 
            display: flex; justify-content: space-between; align-items: center;
        }
        .expiry-select { 
            background: #222; color: #fff; border: 1px solid #444; padding: 4px; font-family: inherit; font-size: 12px; 
        }
        .step-toggle { font-size: 12px; color: #aaa; display: flex; align-items: center; gap: 6px; cursor: pointer; }

        /* The Table */
        .table-scroll { flex: 1; overflow-y: auto; }
        table { width: 100%; border-collapse: collapse; font-size: 12px; text-align: right; }
        th { position: sticky; top: 0; background: #111; color: #666; padding: 8px 4px; font-weight: normal; font-size: 10px; z-index: 10; border-bottom: 1px solid #333; }
        td { padding: 6px 4px; border-bottom: 1px solid #222; }
        
        /* Uniform Columns: 5 Greeks + Strike + 5 Greeks = 11 Cols */
        th, td { width: 8.5%; } 
        .strike-col { width: 15%; text-align: center; background: #1a1a1a; color: #fff; font-weight: bold; position: sticky; left: 0; z-index: 5; border-right: 1px solid #333; border-left: 1px solid #333; }
        
        .atm-row td { background: #222; }
        .iv-cell { font-family: monospace; font-weight: bold; }

    </style>
</head>
<body>

    <div class="header-row">
        <h1>IndIV Monitor</h1>
        
        <select class="asset-select">
            <option>NIFTY 50</option>
            <option>BANK NIFTY</option>
            <option>CRUDE OIL</option>
            <option>GOLD</option>
        </select>

        <div class="controls-right">
            <a href="#" class="readme-link">How to use?</a>
            <div class="status-box">
                <div class="status-ok">‚óè LIVE</div>
                <div style="color:#666; font-size:11px">Updated: 14:35:00</div>
            </div>
        </div>
    </div>

    <div class="container">
        
        <div class="left-panel">
            
            <div class="price-header-box">
                <div class="price-item">
                    <span class="price-label">SPOT PRICE</span>
                    <span class="price-val">26,150.00</span>
                </div>
                <div style="width:1px; height:30px; background:#333"></div> <div class="price-item">
                    <span class="price-label">FUTURES PRICE</span>
                    <span class="price-val">26,187.00 <span class="price-diff">(+37)</span></span>
                </div>
            </div>

            <div class="section-title">
                WEEKLY <span class="section-date">26 DEC 2025</span>
            </div>
            
            <div class="data-grid-3x2">
                <div class="data-box">
                    <span class="lbl">ATM CALL</span>
                    <div class="val-lg c-green">145.20</div>
                </div>
                <div class="data-box" style="border-color: #444; background:#1a1a1a">
                    <span class="lbl">STRADDLE</span>
                    <div class="val-lg c-weekly">284.50</div>
                </div>
                <div class="data-box">
                    <span class="lbl">ATM PUT</span>
                    <div class="val-lg c-red">139.30</div>
                </div>

                <div class="data-box">
                    <span class="lbl">CALL IV</span>
                    <div class="val-xl c-green">12.4%</div>
                </div>
                <div class="data-box" style="border-color: #444; background:#1a1a1a">
                    <span class="lbl">STRADDLE IV</span>
                    <div class="val-xl c-weekly">12.8%</div>
                </div>
                <div class="data-box">
                    <span class="lbl">PUT IV</span>
                    <div class="val-xl c-red">13.1%</div>
                </div>
            </div>

            <div class="chart-box">
                <canvas id="mockIntradayChart"></canvas>
            </div>

            <div class="section-title" style="margin-top:15px;">
                MONTHLY <span class="section-date">29 JAN 2026</span>
            </div>
            
            <div class="data-grid-3x2">
                <div class="data-box">
                    <span class="lbl">ATM CALL</span>
                    <div class="val-lg c-green">310.50</div>
                </div>
                <div class="data-box" style="border-color: #444; background:#1a1a1a">
                    <span class="lbl">STRADDLE</span>
                    <div class="val-lg c-monthly">595.00</div>
                </div>
                <div class="data-box">
                    <span class="lbl">ATM PUT</span>
                    <div class="val-lg c-red">284.50</div>
                </div>

                <div class="data-box">
                    <span class="lbl">CALL IV</span>
                    <div class="val-xl c-green">14.2%</div>
                </div>
                <div class="data-box" style="border-color: #444; background:#1a1a1a">
                    <span class="lbl">STRADDLE IV</span>
                    <div class="val-xl c-monthly">14.5%</div>
                </div>
                <div class="data-box">
                    <span class="lbl">PUT IV</span>
                    <div class="val-xl c-red">14.8%</div>
                </div>
            </div>

            <div class="chart-box" style="margin-top:10px;">
                <canvas id="mockSkewChart"></canvas>
            </div>

        </div>

        <div class="right-panel">
            
            <div class="table-controls">
                <select class="expiry-select" id="tableExpiry" onchange="regenerateTable()">
                    <option value="weekly">Weekly (26 Dec)</option>
                    <option value="monthly">Monthly (29 Jan)</option>
                    <option value="near">Near Month (Feb)</option>
                </select>

                <label class="step-toggle">
                    <input type="checkbox" id="stepToggle" onchange="regenerateTable()"> 
                    Major Strikes Only
                </label>
            </div>

            <div class="table-scroll">
                <table>
                    <thead>
                        <tr>
                            <th colspan="5" style="text-align:center; color:var(--green); border-bottom:1px solid #333;">CALLS</th>
                            <th class="strike-col">K</th>
                            <th colspan="5" style="text-align:center; color:var(--red); border-bottom:1px solid #333;">PUTS</th>
                        </tr>
                        <tr>
                            <th>Gam</th><th>Veg</th><th>The</th><th>Del</th><th>IV%</th>
                            <th class="strike-col"></th>
                            <th>IV%</th><th>Del</th><th>The</th><th>Veg</th><th>Gam</th>
                        </tr>
                    </thead>
                    <tbody id="tableBody">
                        </tbody>
                </table>
            </div>
        </div>

    </div>

<script>
    // --- MOCK LOGIC ---
    
    // 1. Chart
    new Chart(document.getElementById('mockIntradayChart'), {
        type: 'line',
        data: {
            labels: ["9:15", "10:00", "11:00", "12:00", "13:00", "14:00", "Now"],
            datasets: [
                {label:'Weekly IV', data:[12.2, 12.4, 12.1, 12.5, 12.8, 12.6, 12.8], borderColor:'#FF9800', borderWidth:2, pointRadius:0},
                {label:'Monthly IV', data:[14.1, 14.0, 14.2, 14.3, 14.4, 14.5, 14.5], borderColor:'#2196F3', borderWidth:2, pointRadius:0}
            ]
        },
        options: { responsive:true, maintainAspectRatio:false, plugins:{legend:{position:'top', align:'end', labels:{color:'#888', boxWidth:12}}}, scales:{x:{display:false}, y:{grid:{color:'#222'}}} }
    });

    // 2. Skew Chart (Placeholder)
    new Chart(document.getElementById('mockSkewChart'), {
        type: 'line',
        data: {
            labels: [25800, 25900, 26000, 26100, 26200, 26300, 26400],
            datasets: [
                {label:'Call', data:[13, 12.8, 12.6, 12.5, 12.4, 12.3, 12.2], borderColor:'#00E676', borderWidth:1},
                {label:'Put', data:[13.5, 13.2, 13.0, 12.9, 12.8, 12.9, 13.1], borderColor:'#FF5252', borderWidth:1}
            ]
        },
        options: { responsive:true, maintainAspectRatio:false, plugins:{legend:{display:false}}, scales:{x:{display:false}, y:{grid:{color:'#222'}}} }
    });

    // 3. Table Generator
    function regenerateTable() {
        const atm = 26200;
        const tbody = document.getElementById("tableBody");
        const onlyMajor = document.getElementById("stepToggle").checked;
        const rows = [];

        // Generate 15 strikes up/down, then filter
        for(let i=-15; i<=15; i++) {
            let strike = atm + (i*50);
            
            // FILTER: If "Major Only" is checked, skip 50s (assuming 100 is major)
            if(onlyMajor && strike % 100 !== 0) continue;

            // Limit to 10 rows around ATM after filtering (mock logic simplified: just take what passes)
            // In real app, we would slice the array.
            
            let isATM = strike === atm;
            rows.push({
                strike: strike, isATM: isATM,
                c: { iv: 12.5, del: 0.52, th: -12, vg: 15, gm: 0.002 },
                p: { iv: 12.8, del: 0.48, th: -12, vg: 15, gm: 0.002 }
            });
        }

        // Slice to keep table short (Visual Requirement: Max 20 rows)
        const center = Math.floor(rows.length / 2);
        const finalRows = rows.slice(Math.max(0, center-10), Math.min(rows.length, center+11));

        tbody.innerHTML = finalRows.map(r => `
            <tr class="${r.isATM ? 'atm-row' : ''}">
                <td style="color:#666">${r.c.gm}</td>
                <td style="color:#888">${r.c.vg}</td>
                <td style="color:#888">${r.c.th}</td>
                <td class="c-green">${r.c.del}</td>
                <td class="iv-cell c-green">${r.c.iv}</td>
                
                <td class="strike-col">${r.strike}</td>
                
                <td class="iv-cell c-red">${r.p.iv}</td>
                <td class="c-red">${r.p.del}</td>
                <td style="color:#888">${r.p.th}</td>
                <td style="color:#888">${r.p.vg}</td>
                <td style="color:#666">${r.p.gm}</td>
            </tr>
        `).join("");
    }

    // Init
    regenerateTable();

</script>
</body>
</html>
